# Basic Gazelle

This example can originally be found in the [`rules_go` examples](https://github.com/bazel-contrib/rules_go/blob/master/examples/basic_gazelle/README.md). This readme includes additional information for the readers.

[Gazelle](https://github.com/bazel-contrib/bazel-gazelle) is a tool that generates and updates Bazel build files. You can use it to generate build files when migrating to Bazel, to maintain existing build files, and to import external Go modules that have not been migrated to Bazel.

This example shows how to use Gazelle to generate build files for a small Go program with an external dependency.

To understand how this project works, read these files:

- `MODULE.bazel`: declares dependencies on Bazel modules, including rules_go and Gazelle.
- `go.mod`: declares dependencies on Go modules. Maintained outside of Bazel with normal Go commands like `go mod tidy`.
- `BUILD.bazel`: contains some boilerplate for running Gazelle, as well as targets generated by Gazelle.

To update generated build files, run the command below. This should be done after you add, remove, or rename source files or when you change imports.

```bash
bazel run //:gazelle
```

For example, rename `printlinks.go` to `print_links.go`, run Gazelle, and observe the change in `BUILD.bazel`.

To add a new external dependency:

1. Import the external package from any `.go` file.
1. Run `bazel run @rules_go//go -- mod tidy`. This command runs `go mod tidy` to update `go.mod` using the toolchain downloaded by `rules_go`. This command also runs `bazel mod tidy` to update `MODULE.bazel` .
1. Run `bazel run //:gazelle` again to update dependencies in `BUILD.bazel` files.

<!-- End original README.md -->

# Note

In this example, we use the `toolchains_musl` Bazel module to build the Go program with the musl libc. This is useful if you don't have a GCC or CC in your path.

You'll need to install the musl libc package on your system.
- On Debian/Ubuntu: `sudo apt install musl`

# Next

Now, move to the [protobuf](../003-hello-proto/README.md) example.
